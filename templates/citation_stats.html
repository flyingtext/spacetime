{% extends "base.html" %}
{% block title %}{{ _('Citation Statistics') }}{% endblock %}
{% block content %}
<h1>{{ _('Citation Statistics') }}</h1>
  <table class="table citation-table">
  {% for item in stats %}
  <tr>
    <td>
      {% if item.doi %}
        <a href="https://doi.org/{{ item.doi }}">{{ item.doi }}</a>
      {% elif item.citation_text.startswith('http://') or item.citation_text.startswith('https://') %}
        <a href="{{ item.citation_text }}">{{ item.citation_text }}</a>
      {% else %}
        <a href="https://scholar.google.com/scholar?q={{ item.citation_text | urlencode }}">{{ item.citation_text }}</a>
      {% endif %}
      ({{ item.count }})
      <form method="post" action="{{ url_for('delete_citation_everywhere') }}" class="d-inline ms-2" onsubmit="return confirm('{{ _('Are you sure?') }}');">
        <input type="hidden" name="doi" value="{{ item.doi | default('') }}" />
        <input type="hidden" name="citation_text" value="{{ item.citation_text }}" />
        <button type="submit" class="btn btn-sm btn-danger">{{ _('Delete') }}</button>
      </form>
    </td>
  </tr>
  <tr>
    <td>
      {% for post in item.posts %}
        <a href="{{ url_for('document', language=post.language, doc_path=post.path) }}">{{ post.display_title }}</a>{% if not loop.last %}, {% endif %}
      {% endfor %}
    </td>
  </tr>
  {% endfor %}
  </table>
<nav>
  <ul class="pagination justify-content-center mt-4">
    <li class="page-item{% if not pagination.has_prev %} disabled{% endif %}">
      <a class="page-link" href="{{ url_for('citation_stats', page=pagination.prev_num) }}">&laquo;</a>
    </li>
    {% if pagination.pages <= 7 %}
      {% for p in range(1, pagination.pages + 1) %}
        <li class="page-item{% if p == pagination.page %} active{% endif %}">
          <a class="page-link" href="{{ url_for('citation_stats', page=p) }}">{{ p }}</a>
        </li>
      {% endfor %}
    {% else %}
      {% for p in pagination.iter_pages(left_edge=2, right_edge=2, left_current=2, right_current=2) %}
        {% if p %}
          <li class="page-item{% if p == pagination.page %} active{% endif %}">
            <a class="page-link" href="{{ url_for('citation_stats', page=p) }}">{{ p }}</a>
          </li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">â€¦</span></li>
        {% endif %}
      {% endfor %}
    {% endif %}
    <li class="page-item{% if not pagination.has_next %} disabled{% endif %}">
      <a class="page-link" href="{{ url_for('citation_stats', page=pagination.next_num) }}">&raquo;</a>
    </li>
  </ul>
</nav>
{% endblock %}
