{% extends "base.html" %}
{% block title %}{{ _('Posts') }}{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="mb-0">{% if tag %}{{ _('Posts tagged "%(tag)s"', tag=tag.name) }}{% else %}{{ _('All Posts') }}{% endif %}</h1>
  {% if current_user.is_authenticated %}
    <a href="{{ url_for('create_post') }}" class="btn btn-primary">{{ _('New Post') }}</a>
  {% endif %}
</div>
{% if categories %}
  <div class="mb-3">
    {% for slug, label in categories %}
      <a class="btn btn-outline-secondary btn-sm{% if tag and tag.name == slug %} active{% endif %}" href="{{ url_for('all_posts', tag=slug) }}">{{ label }}</a>
    {% endfor %}
  </div>
{% endif %}
<ul id="post-list" class="list-group mb-3">
  {% for post in pagination.items %}
    <li class="list-group-item d-flex flex-wrap align-items-center gap-2">
      <a href="{{ url_for('document', language=post.language, doc_path=post.path) }}">{{ post.display_title }}</a>
      <span class="text-muted">{{ post.path }} ({{ post.language }})</span>
      <small class="text-muted">{{ _('by') }} <a href="{{ url_for('profile', username=post.author.username) }}">{{ post.author.username }}</a></small>
    </li>
  {% else %}
    <li class="list-group-item">{{ _('No posts yet.') }}</li>
  {% endfor %}
</ul>
<nav>
  <ul class="pagination">
    <li class="page-item{% if not pagination.has_prev %} disabled{% endif %}">
      <a class="page-link" href="{{ url_for('all_posts', page=pagination.prev_num, tag=tag.name if tag else None) }}">&laquo;</a>
    </li>
    {% for p in range(1, pagination.pages + 1) %}
    <li class="page-item{% if p == pagination.page %} active{% endif %}"><a class="page-link" href="{{ url_for('all_posts', page=p, tag=tag.name if tag else None) }}">{{ p }}</a></li>
    {% endfor %}
    <li class="page-item{% if not pagination.has_next %} disabled{% endif %}">
      <a class="page-link" href="{{ url_for('all_posts', page=pagination.next_num, tag=tag.name if tag else None) }}">&raquo;</a>
    </li>
  </ul>
</nav>
{% endblock %}
